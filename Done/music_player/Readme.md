# 主题: 智能音箱

# 设计内容
## 音响
0. 播放音乐<br>相当于一个基本的音响的功能
	1. 上一首
	2. 下一首
	3. 切换播放模式
		0. 顺序播放
		1. 循环单曲播放
1. 播放今天的日期?
2. 播放今天的天气?
3. 通过按键来进行其他设备的操作(比如大门, 窗帘, 空调之类的)?

## 按键

## LED灯
通过LED灯判断音乐播放的状态

## 音箱工作要求
0. 监听按键<br>(读取设备文件)通过按键判断接下来要做什么
1. 监听网络<br>
>通过函数select可以操作文件描述符, 进行设备管理里, 对以上两个进行操作,使用多进程程序来进行操作的管理(3进程), 

# 设计方案
## 进程
0. 进程分配<br>&emsp;本项目使用3个进程, 父进程=>select: 监听案件和网络; 子进程 => wait 孙进程结束; 孙进程 => 播放音乐;
0. 进程间通信<br>共享内存的方式
>共享内存:1. 进程号; 2. 当前播放的音乐; 3. 播放模式
## 音乐播放进程管理
1. 暂停:<br> 父进程给子孙进程发送SiGSTOP, 同时将每个进程号发送的共享内存中
2. 继续:<br> 父进程给子进程和孙进程发送SIGCONT
3. 上一首:<br> 通过链表把把u盘所有的歌曲名称读出, 存放在链表中(双向链表), 父进程通过之前播放的音乐找到上一首; 杀死子进程孙进程, 重新启动进程通过共享内存中的音乐名播放音乐
4. 播放音乐:<br>父进程首先找到当前播放的音乐, 遍历链表
5. 播放模式切换:<br>通过共享内存切换播放模式

## 音频解码库
&emsp;本项目使用madplay库进行音频解码
### madplay Install
0. ubuntu使用apt安装<br>apt-get install madplay
1. 使用源码makefile进行安装<br>
	0. cd path(源码目录)
	1. ./configure 生成makefile
	2. make
	3. make install
0. madplay安装目录<br>usr/bin/madplay

# 参考
0. [bilibili](https://www.bilibili.com/video/BV1he411W7QG?p=5)
0. [madplay](https://www.madplay.co.uk/)
0. [野火linux开发板]()